<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.lgy.smile.dao.ChattingInterface">

  	<insert id="write" parameterType="hashmap">
	    INSERT INTO chatting VALUES (
	    	null , #{board} , #{seller} , #{chattingroom}, #{sender}, #{sendtime}, #{msg}, #{receiver}
	    )
  	</insert>

  	<select id="list" resultType="com.lgy.smile.dto.ChattingDto">
	    SELECT * 
	    FROM chatting
	    ORDER BY identity DESC
  	</select>
  	
  	<select id="contentView" resultType="com.lgy.smile.dto.ChattingDto" parameterType="int">
	    SELECT * 
	    FROM chatting
	    WHERE chattingroom = #{chattingroom}
  	</select>
  	
  	<select id="countCheck" resultType="int" parameterType="int">
	    SELECT 
			COUNT(identity) "count"
		FROM 
			smile.chatting
		WHERE 
			chattingroom = #{chattingroom}
  	</select>
  	
  	<select id="lastContent" resultType="com.lgy.smile.dto.ChattingDto" parameterType="int">
		SELECT 
			*
		    , (SELECT COUNT(*) FROM smile.chatting WHERE chattingroom = chat.chattingroom) "count"
		FROM 
			smile.chatting chat
		WHERE 
			chattingroom = 51
		ORDER BY
			identity DESC
		LIMIT 
			0, 1
  	</select>
  	
  	<select id="getImgPath" resultType="String" parameterType="hashmap">
		SELECT 
			imgPath
		FROM 
			smile.user
		WHERE
			identity = ${userIdentity}
  	</select>
  	
  	

</mapper>